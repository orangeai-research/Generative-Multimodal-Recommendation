# RFGUME: Rectified Flow for GUME
# 使用Rectified Flow生成extended_id_embeds

# Stage 1: Search rf_loss_weight only
hyper_parameters: ["rf_loss_weight"]

# ===== Base Settings (inherited from GUME) =====
embedding_size: 64
learning_rate: 0.001
learning_rate_scheduler: [0.96, 20]

# ===== GUME Parameters =====
n_ui_layers: 3
knn_k: 10

# Loss weights for GUME
bm_loss: 0.01

# Regularization
reg_weight_1: 1e-05
reg_weight_2: 0.1

# ===== Rectified Flow Parameters =====
use_rf: True

# RF Network Architecture
rf_hidden_dim: 128
rf_n_layers: 2
rf_dropout: 0.1

# RF Training
rf_learning_rate: 0.0003  # Fixed for Stage 1
rf_loss_weight: [0.2, 0.4, 0.6]  # Stage 1: Search this
rf_sampling_steps: 10

# User Interest Guidance (Prior Knowledge)
use_user_guidance: True
user_guidance_scale: 0.2
guidance_decay_power: 2.0

# Cosine Similarity Gradient Guidance
use_cosine_guidance: True
cosine_guidance_scale: 0.1
cosine_decay_power: 2.0

# RF Warmup
rf_warmup_epochs: 20

# RF 混合策略
rf_mix_ratio: 0
rf_inference_mix_ratio: 0.05  # Fixed for Stage 1
rf_contrast_temp: 0.1

# 2-RF (Reflow) parameters
use_2rf: False
rf_2rf_transition_epoch: 20

# Memory optimization
use_gradient_checkpointing: True

# Causal denoising parameters (IPW-based)
use_denoise: True
clean_rating_threshold: 5.0
denoise_layers: 2
ps_loss_weight: 0.1

# ===== Dataset-Specific Configurations =====
# Baby dataset
n_layers: 2
bm_temp: 0.4
um_loss: 0.01
um_temp: 0.1
vt_loss: 0.1

# # Sports dataset
# n_layers: 1
# bm_temp: 0.2
# um_loss: 0.01
# um_temp: 0.1
# vt_loss: 0.01

# # Clothing dataset
# n_layers: 1
# bm_temp: 0.2
# um_loss: 0.1
# um_temp: 0.2
# vt_loss: 0.001

# Wandb settings
use_wandb: True
wandb_project: "GenMMRec_RFGUME_SEARCH"
